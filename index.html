<html>
  <head>
    <meta charset="utf-8" />
    <title>Concert d'à coté prototype 1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <!-- Elément Google Maps indiquant que la carte doit être affiché en plein écran et
        qu'elle ne peut pas être redimensionnée par l'utilisateur -->
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <!-- Inclusion de l'API Google MAPS -->
        <!-- Le paramètre "sensor" indique si cette application utilise détecteur pour déterminer la position de l'utilisateur -->
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.0/jquery.min.js"></script>
        <script type="text/javascript">
            function initialiser() {
                var latlng = new google.maps.LatLng(48.8551171, 2.330785600000013);
                //objet contenant des propriétés avec des identificateurs prédéfinis dans Google Maps permettant
                //de définir des options d'affichage de notre carte
                var options = {
                    center: latlng,
                    zoom: 12,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                 
                //constructeur de la carte qui prend en paramêtre le conteneur HTML
                //dans lequel la carte doit s'afficher et les options
                var carte = new google.maps.Map(document.getElementById("carte"), options);
            }

            //c'est ma fonction qui actualise la maps a chaque fois qu'on click dessus !
            //pour tester mettez bien des cordonnées qui son en france!!!

            function overlay() {
$(function() 
{
$(document).ready(function()
{




$.ajax({
                type: 'GET',
                url: '/concert',
                dataType: 'json',
                contentType: 'application/json',
                success: function(response) {
var latlng = new google.maps.LatLng(parseFloat(document.getElementById("Lat").value), parseFloat(document.getElementById("Lng").value));
                //objet contenant des propriétés avec des identificateurs prédéfinis dans Google Maps permettant
                //de définir des options d'affichage de notre carte

                var options = {
                    center: latlng,
                    zoom: 12,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                 
                //constructeur de la carte qui prend en paramêtre le conteneur HTML
                //dans lequel la carte doit s'afficher et les options
                var carte = new google.maps.Map(document.getElementById("carte"), options);

var pinColor = "#79CDCD";
    var pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + pinColor,
        new google.maps.Size(21, 34),
        new google.maps.Point(0,0),
        new google.maps.Point(10, 34));


var marqueur = new google.maps.Marker({
        position: new google.maps.LatLng(parseFloat(document.getElementById("Lat").value), parseFloat(document.getElementById("Lng").value)),
        map: carte,
        title: "Vous etes ici",
        icon: pinImage
        });

var myWindowOptions = {
  content:  '<h3>Vous etes ici</h3>'
};

var myInfoWindow = new google.maps.InfoWindow(myWindowOptions);
google.maps.event.addListener(marqueur, 'click', function() {
  myInfoWindow.open(carte,marqueur);
});
                  
                 for (var i = 0 ; i < response.length; i++) {
alert(response[i].venue.location['geo:point']['geo:lat']);
alert(response[i].venue.location['geo:point']['geo:long']);
                  var marqueur = new google.maps.Marker({
        position: new google.maps.LatLng(parseFloat(response[i].venue.location['geo:point']['geo:lat']), parseFloat(response[i].venue.location['geo:point']['geo:long'])),
        map: carte,
        title: response[i].titre
        });

var myWindowOptions = {
  content:  '<h3>'+response[i].titre+'</h3>' 
};

var myInfoWindow = new google.maps.InfoWindow(myWindowOptions);
google.maps.event.addListener(marqueur, 'click', function() {
  myInfoWindow.open(carte,marqueur);
});
                     $('#content').html(response[i].venue.location['geo:point']['geo:lat']);
                 };
                  
                }
            });
});
});
                   

            }
        </script>
  </head>

  <body onload="initialiser()">

    <form id="myForm">
      <label for="adr"> Adresse :</label> <input name="adr" type="text" id="adr" /></br>
      <label for="Lat"> Lattitude :</label> <input name="Lat" type="text" id="Lat" />
       <label for="Lng"> Longitude :</label> <input name="Lng" type="text" id="Lng" />
        <label for="Rayon"> Rayon (en Km):</label> <input name="Rayon" type="text" id="Rayon" />
      <br /><br />
      <input type="button" value="Valider" id="valider" onclick = "overlay()"/>
      <input type="reset" value="Reset !" />
    </form>
      


<div id="carte" style="width:50%; height:75%"></div>

<div id="content"></div>
  </body>
</html>